================================================================================
                    ğŸ”§ FIX LANDING PAGE STATISTICS
================================================================================

PROBLEM: Landing page shows no statistics (blank or 0)

CAUSE: Row Level Security (RLS) blocking anonymous access to issues table

SOLUTION: Run this SQL in Supabase (30 seconds!)

================================================================================
                              COPY THIS SQL
================================================================================

ALTER TABLE issues ENABLE ROW LEVEL SECURITY;

DROP POLICY IF EXISTS "public_read_issues" ON issues;

CREATE POLICY "public_read_issues"
ON issues
FOR SELECT
TO anon, authenticated
USING (true);

SELECT 
  COUNT(*) as total_issues,
  COUNT(*) FILTER (WHERE status = 'resolved') as resolved_issues,
  COUNT(DISTINCT created_by) as active_citizens
FROM issues;

================================================================================
                              HOW TO RUN
================================================================================

1. Go to https://supabase.com/dashboard
2. Select your project
3. Click "SQL Editor" (left sidebar)
4. Click "New Query"
5. Copy the SQL above
6. Paste it
7. Click "RUN"

================================================================================
                              VERIFY IT WORKS
================================================================================

The last SELECT should show:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ total_issues  â”‚ resolved_issues  â”‚ active_citizens  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 5             â”‚ 2                â”‚ 3                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

(Your numbers will vary)

================================================================================
                              TEST THE FIX
================================================================================

1. Refresh your landing page
2. Statistics should now appear!
3. Open browser console (F12) to see logs:
   - "Fetching landing page statistics..."
   - "Total issues count: X"
   - "âœ… Statistics updated successfully"

================================================================================
                              TROUBLESHOOTING
================================================================================

âŒ Still showing 0?
   â†’ Check browser console (F12) for errors
   â†’ Make sure you have issues in the database:
     SELECT COUNT(*) FROM issues;

âŒ Error: "policy already exists"
   â†’ Good! The policy was already there
   â†’ Try the DROP POLICY command first, then CREATE again

âŒ Error: "permission denied"
   â†’ Make sure you're logged in as project owner

================================================================================
                              WHAT THIS DOES
================================================================================

âœ“ Enables Row Level Security on issues table
âœ“ Drops any old conflicting policies
âœ“ Creates new policy allowing public read access
âœ“ Tests that the query works

This allows the landing page to fetch statistics without authentication.

================================================================================
                              FILES CREATED
================================================================================

â†’ FIX_LANDING_STATS_NOW.sql (the SQL script)
â†’ LANDING_PAGE_STATS_FIX.md (detailed guide)
â†’ FIX_STATS_QUICK.txt (this file)

================================================================================
                              SUMMARY
================================================================================

Time: 30 seconds
Difficulty: Easy (just copy-paste SQL)
Risk: None (only adds read permission)
Impact: Statistics will appear on landing page

Questions? Check LANDING_PAGE_STATS_FIX.md for detailed troubleshooting!

================================================================================
