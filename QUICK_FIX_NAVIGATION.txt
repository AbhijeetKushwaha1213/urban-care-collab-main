================================================================================
                    ðŸ—ºï¸ QUICK FIX: Navigation Not Working
================================================================================

PROBLEM: "Location coordinates not available" error when clicking Get Directions

CAUSE: Database missing latitude and longitude columns

SOLUTION: Run this SQL script in Supabase (takes 30 seconds!)

================================================================================
                              STEP-BY-STEP FIX
================================================================================

1. Open Supabase Dashboard
   â†’ https://supabase.com/dashboard
   â†’ Select your project
   â†’ Click "SQL Editor" (left sidebar)

2. Copy and paste this SQL:

   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                                                                     â”‚
   â”‚  ALTER TABLE issues                                                 â”‚
   â”‚  ADD COLUMN IF NOT EXISTS latitude DECIMAL(10, 8),                  â”‚
   â”‚  ADD COLUMN IF NOT EXISTS longitude DECIMAL(11, 8);                 â”‚
   â”‚                                                                     â”‚
   â”‚  CREATE INDEX IF NOT EXISTS idx_issues_coordinates                  â”‚
   â”‚  ON issues(latitude, longitude);                                    â”‚
   â”‚                                                                     â”‚
   â”‚  ALTER TABLE issues                                                 â”‚
   â”‚  ADD CONSTRAINT IF NOT EXISTS check_latitude_range                  â”‚
   â”‚  CHECK (latitude IS NULL OR (latitude >= -90 AND latitude <= 90)); â”‚
   â”‚                                                                     â”‚
   â”‚  ALTER TABLE issues                                                 â”‚
   â”‚  ADD CONSTRAINT IF NOT EXISTS check_longitude_range                 â”‚
   â”‚  CHECK (longitude IS NULL OR (longitude >= -180 AND longitude <=   â”‚
   â”‚         180));                                                      â”‚
   â”‚                                                                     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. Click "RUN" button (or press Ctrl+Enter)

4. Wait for "Success" message

5. Verify it worked:

   SELECT column_name FROM information_schema.columns 
   WHERE table_name = 'issues' 
   AND column_name IN ('latitude', 'longitude');

   Should show:
   âœ“ latitude
   âœ“ longitude

================================================================================
                              THAT'S IT! âœ…
================================================================================

NOW:
âœ“ New issues will automatically save coordinates
âœ“ "Get Directions" button will work
âœ“ Navigation features fully functional

TEST:
1. Report a new issue (use "Pick on Map" or "Use Current Location")
2. Open it in official portal
3. Click "GET DIRECTIONS IN GOOGLE MAPS"
4. Should open Google Maps with route! ðŸŽ‰

================================================================================
                         FOR EXISTING ISSUES
================================================================================

If you have old issues without coordinates, run this AFTER the above:

UPDATE issues
SET 
  latitude = CAST(SPLIT_PART(location, ',', 1) AS DECIMAL),
  longitude = CAST(SPLIT_PART(location, ',', 2) AS DECIMAL)
WHERE 
  (latitude IS NULL OR longitude IS NULL)
  AND location ~ '^-?\d+\.?\d*,\s*-?\d+\.?\d*$';

This extracts coordinates from location strings like "28.6139, 77.2090"

================================================================================
                            TROUBLESHOOTING
================================================================================

âŒ Error: "column already exists"
   âœ… Good! It means columns were already added. Continue testing.

âŒ Error: "permission denied"
   âœ… Make sure you're logged in as project owner in Supabase

âŒ Still showing "coordinates not available"
   âœ… Check if issue has coordinates:
      SELECT latitude, longitude FROM issues WHERE id = 'issue-id';
   âœ… If NULL, the issue was created before the fix
   âœ… Report a NEW issue to test

================================================================================
                          DETAILED DOCUMENTATION
================================================================================

For complete guide, see:
â†’ DATABASE_SETUP_COORDINATES.md
â†’ COORDINATES_FIX_COMPLETE.md
â†’ docs/migration/add-coordinates-columns.sql

================================================================================
                              SUMMARY
================================================================================

Time Required: 30 seconds
Difficulty: Easy (just copy-paste SQL)
Risk: None (uses IF NOT EXISTS)
Impact: Fixes navigation for all new issues

Questions? Check the documentation files above!

================================================================================
